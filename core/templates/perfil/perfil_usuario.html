{% extends base_template %}
{% load static widget_tweaks %}

{% block extra_head %}
  <link rel="stylesheet" href="{% static 'css/perfil_usuario.css' %}">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
{% endblock %}

{% block panel_content %}
<div class="profile-container">
  <!-- Header del Perfil -->
  <div class="profile-header">
    <div class="row align-items-center">
      <div class="col-md-4 text-center">
        <div class="avatar-section">
          {% if perfil and perfil.foto %}
            <img src="{{ perfil.foto.url }}" alt="Foto de perfil" class="profile-avatar">
          {% else %}
            <div class="profile-avatar avatar-placeholder">
              <i class="fas fa-user"></i>
            </div>
          {% endif %}
          <div class="role-badge">
            <i class="fas fa-shield-alt me-1"></i>{{ usuario.rol.nombre }}
          </div>
        </div>
      </div>
      <div class="col-md-8">
        <h1 class="profile-title">
          <i class="fas fa-user-circle me-2"></i>Perfil de Usuario
        </h1>
        <div class="profile-subtitle">
          Información personal y datos de contacto
        </div>
        <div class="profile-meta">
          <span class="meta-item">
            <i class="fas fa-envelope me-1"></i>{{ usuario.email }}
          </span>
          <span class="meta-item">
            <i class="fas fa-calendar-alt me-1"></i>
            Registrado el {{ usuario.date_joined|date:"j \\d\\e F \\d\\e Y" }}
          </span>
        </div>
      </div>
    </div>
  </div>

  {% if perfil %}
  <!-- Información Personal -->
  <div class="info-card">
    <div class="card-header">
      <h3><i class="fas fa-id-card me-2"></i>Información Personal</h3>
    </div>
    <div class="card-content">
      <div class="row">
        <div class="col-md-6">
          <div class="info-group">
            <label><i class="fas fa-user me-1"></i>Primer nombre</label>
            <span>{{ perfil.primer_nombre }}</span>
          </div>
        </div>
        <div class="col-md-6">
          <div class="info-group">
            <label><i class="fas fa-user me-1"></i>Segundo nombre</label>
            <span>{{ perfil.segundo_nombre|default_if_none:"No especificado" }}</span>
          </div>
        </div>
        <div class="col-md-6">
          <div class="info-group">
            <label><i class="fas fa-user-tag me-1"></i>Primer apellido</label>
            <span>{{ perfil.primer_apellido }}</span>
          </div>
        </div>
        <div class="col-md-6">
          <div class="info-group">
            <label><i class="fas fa-user-tag me-1"></i>Segundo apellido</label>
            <span>{{ perfil.segundo_apellido|default_if_none:"No especificado" }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Documentación -->
  <div class="info-card">
    <div class="card-header">
      <h3><i class="fas fa-file-alt me-2"></i>Documentación</h3>
    </div>
    <div class="card-content">
      <div class="row">
        <div class="col-md-6">
          <div class="info-group">
            <label><i class="fas fa-id-card-alt me-1"></i>Tipo de documento</label>
            <span>{{ usuario.tipo_documento }}</span>
          </div>
        </div>
        <div class="col-md-6">
          <div class="info-group">
            <label><i class="fas fa-hashtag me-1"></i>Número de documento</label>
            <span>{{ usuario.numero_documento }}</span>
          </div>
        </div>
        <div class="col-md-12">
          <div class="info-group">
            <label><i class="fas fa-map-marker-alt me-1"></i>Municipio de expedición</label>
            <span>
              {% if usuario.municipio_identificacion %}
                {{ usuario.municipio_identificacion.nombre }}
              {% else %}
                <span class="text-muted">No especificado</span>
              {% endif %}
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Ubicación -->
  <div class="info-card">
    <div class="card-header">
      <h3><i class="fas fa-home me-2"></i>Ubicación</h3>
    </div>
    <div class="card-content">
      <div class="row">
        <div class="col-md-6">
          <div class="info-group">
            <label><i class="fas fa-road me-1"></i>Dirección línea 1</label>
            <span>{{ perfil.direccion_linea1 }}</span>
          </div>
        </div>
        <div class="col-md-6">
          <div class="info-group">
            <label><i class="fas fa-road me-1"></i>Dirección línea 2</label>
            <span>{{ perfil.direccion_linea2|default_if_none:"No especificado" }}</span>
          </div>
        </div>
        <div class="col-md-4">
          <div class="info-group">
            <label><i class="fas fa-city me-1"></i>Ciudad</label>
            <span>{{ perfil.ciudad.nombre }}</span>
          </div>
        </div>
        <div class="col-md-4">
          <div class="info-group">
            <label><i class="fas fa-map me-1"></i>Departamento</label>
            <span>{{ perfil.ciudad.departamento.nombre }}</span>
          </div>
        </div>
        <div class="col-md-4">
          <div class="info-group">
            <label><i class="fas fa-flag me-1"></i>País</label>
            <span>{{ perfil.ciudad.departamento.pais.nombre }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>
  {% else %}
  <!-- Sin Perfil -->
  <div class="info-card no-profile">
    <div class="card-content text-center">
      <div class="no-profile-icon">
        <i class="fas fa-user-slash"></i>
      </div>
      <h3>Sin Perfil Configurado</h3>
      <p>Este usuario no tiene un perfil creado. Crea uno para completar tu información.</p>
    </div>
  </div>
  {% endif %}

  <!-- Acciones -->
  <div class="actions-section">
    <a href="{% url 'editar_perfil' %}" class="btn-edit">
      <i class="fas fa-edit me-2"></i>Editar Perfil
    </a>
  </div>
</div>
{% endblock %}